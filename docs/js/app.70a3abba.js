(function(){"use strict";var o={3985:function(o,t,e){var s=e(9318),r=e(700);function n(o,t){const e=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.Wv)(e)}var i=e(5253);const l={},a=(0,i.A)(l,[["render",n]]);var c=a,d=e(83);const h={class:"home wh-100"},k={class:"view-3d wh-100 position-relative",ref:"v3d"};function u(o,t,e,s,n,i){const l=(0,r.g2)("UiPanel"),a=(0,r.g2)("KeyHelpmer"),c=(0,r.g2)("ToolBar");return(0,r.uX)(),(0,r.CE)("div",h,[(0,r.Lk)("div",k,[(0,r.Lk)("canvas",{onClick:t[0]||(t[0]=(...o)=>i.onClick&&i.onClick(...o)),ref:"canvas",onMousemove:t[1]||(t[1]=(...o)=>i.onMove&&i.onMove(...o))},null,544),(0,r.bF)(l,{floors:n.hiddenFloors,construction:n.construction,selected:n.selection?n.selection.uuid:null,onRemove:i.removeSelection,onRotate:i.rotateSelection,onDeselect:i.onDeselect,onAddPart:i.addPart,cursor:n.cursor,onColor:i.setColor,onSave:i.save,onLoadFile:i.loadFile,onToggleFloor:i.toggleFloor,onUpdatePos:i.updateCursor,ref:"uiPanel",onReset:i.reset,onUp:t[2]||(t[2]=o=>i.moveCursor(0,1,0)),onDown:t[3]||(t[3]=o=>i.moveCursor(0,-1,0))},null,8,["floors","construction","selected","onRemove","onRotate","onDeselect","onAddPart","cursor","onColor","onSave","onLoadFile","onToggleFloor","onUpdatePos","onReset"]),(0,r.bF)(a),(0,r.bF)(c,{selection:n.selection,tool:n.tool,onTool:i.onTool,onColor:i.setColor},null,8,["selection","tool","onTool","onColor"]),t[4]||(t[4]=(0,r.Lk)("div",{class:"about"},"abrakadobr 2025 for FREEDOM DayZ. with contribution by Vlad Kobranov",-1))],512)])}e(4114),e(8111),e(2489),e(7588);var p=e(1419),m=e(4624),w=e(9983),y=e(5608),v=e(1876);const f={class:"ui-panel"},g={class:"tool-group"},b={class:"tool-button"},L=["onClick"],C={class:"tool-group"},x={class:"tool-button"},M={class:"tool-button selected tool-button-w2"},F={class:"tool-button"},j={class:"tool-button selected tool-button-w2"},I={class:"tool-button"},E={class:"tool-button selected tool-button-w2"},P={class:"bottom-panel"},A={class:"tool-group"},O={class:"tool-group"},z={class:"tool-button"},B={class:"tool-button"},X={class:"tool-button"},R={class:"tool-button"},$={class:"tool-group"},D={for:"load-file",class:"tool-button"};function S(o,t,e,s,n,i){const l=(0,r.g2)("FloorsIcon"),a=(0,r.g2)("PlanksIcon"),c=(0,r.g2)("NailsIcon"),d=(0,r.g2)("CodelockIcon"),h=(0,r.g2)("UpIcon"),k=(0,r.g2)("DownIcon"),u=(0,r.g2)("CursorIcon"),p=(0,r.g2)("SaveIcon"),m=(0,r.g2)("LoadIcon"),w=(0,r.g2)("NewIcon");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",f,[(0,r.Lk)("div",g,[(0,r.Lk)("div",b,[(0,r.bF)(l)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.layers,(t=>((0,r.uX)(),(0,r.CE)("button",{key:t,onClick:e=>o.$emit("toggleFloor",t),class:(0,v.C4)(["tool-button",{selected:!e.floors.includes(t)}])},(0,v.v_)(t),11,L)))),128))]),(0,r.Lk)("div",C,[(0,r.Lk)("div",x,[(0,r.bF)(a)]),(0,r.Lk)("div",M,(0,v.v_)(i.resources.planks),1),(0,r.Lk)("div",F,[(0,r.bF)(c)]),(0,r.Lk)("div",j,(0,v.v_)(i.resources.nails),1),(0,r.Lk)("div",I,[(0,r.bF)(d)]),(0,r.Lk)("div",E,(0,v.v_)(i.resources.codelocks),1)])]),(0,r.Lk)("div",P,[(0,r.Lk)("div",A,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>o.$emit("up")),class:"tool-button"},[(0,r.bF)(h)]),(0,r.Lk)("button",{onClick:t[1]||(t[1]=t=>o.$emit("down")),class:"tool-button"},[(0,r.bF)(k)])]),(0,r.Lk)("div",O,[(0,r.Lk)("div",z,[(0,r.bF)(u)]),(0,r.Lk)("div",B,(0,v.v_)(e.cursor[0]),1),(0,r.Lk)("div",X,(0,v.v_)(e.cursor[1]),1),(0,r.Lk)("div",R,(0,v.v_)(e.cursor[2]),1)]),(0,r.Lk)("div",$,[(0,r.Lk)("button",{onClick:t[2]||(t[2]=t=>o.$emit("save")),class:"tool-button"},[(0,r.bF)(p)]),(0,r.Lk)("label",D,[(0,r.bF)(m),(0,r.Lk)("input",{type:"file",id:"load-file",class:"d-none",accept:".json",ref:"fileInput",onChange:t[3]||(t[3]=t=>o.$emit("loadFile",t.target.files[0]))},null,544)]),(0,r.Lk)("button",{onClick:t[4]||(t[4]=t=>o.$emit("reset")),class:"tool-button"},[(0,r.bF)(w)])])])],64)}const K={xmlns:"http://www.w3.org/2000/svg","xml:space":"preserve",width:"32",height:"32",viewBox:"0 0 7.533 7.533"};function H(o,t){return(0,r.uX)(),(0,r.CE)("svg",K,t[0]||(t[0]=[(0,r.Lk)("path",{d:"m1.477 1.398 2.117 4.866.072-.19.629-1.648 1.959-.58Zm.335.36L5.81 3.805l-1.641.486-.586 1.531z",style:{color:"#000",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":".235405","stroke-dasharray":"none"}},null,-1)]))}const T={},_=(0,i.A)(T,[["render",H]]);var Z=_;const N={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function W(o,t){return(0,r.uX)(),(0,r.CE)("svg",N,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M1.202 1.092h6.292l-.66 1.22-4.853.02ZM1.202 5.727h6.292l-.66-1.22-4.853-.02Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"},transform:"translate(-.115 .824)"},null,-1),(0,r.Lk)("path",{d:"M1.144 3.385h6.344",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"translate(-.115 .824)"},null,-1)]))}const U={},V=(0,i.A)(U,[["render",W]]);var Y=V;const q={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Q(o,t){return(0,r.uX)(),(0,r.CE)("svg",q,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M1.524 2.155v4.71l.357.773.302-.807V2.147M.427 2.139h2.794",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"rotate(45 3.122 7.13)"},null,-1)]))}const J={},G=(0,i.A)(J,[["render",Q]]);var oo=G;const to={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function eo(o,t){return(0,r.uX)(),(0,r.CE)("svg",to,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M2.005 6.012H7.83l-1.052.835H.953Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"},transform:"translate(-.158 -1.518)"},null,-1),(0,r.Lk)("path",{d:"M2.005 5.35H7.83l-1.052.835H.953Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"},transform:"translate(-.158 -1.518)"},null,-1),(0,r.Lk)("path",{d:"M2.005 4.655H7.83l-1.052.836H.953Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"},transform:"translate(-.158 -1.518)"},null,-1)]))}const so={},ro=(0,i.A)(so,[["render",eo]]);var no=ro;const io={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function lo(o,t){return(0,r.uX)(),(0,r.CE)("svg",io,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M-.121.994h6.297v6.297H-.121z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":"none","stroke-opacity":"1","paint-order":"markers fill stroke"},transform:"translate(1.32 .087)"},null,-1),(0,r.Lk)("path",{d:"M.617 1.708h4.747v1.237H.617zM.755 3.617h.775v.71H.755zM2.599 3.617h.775v.71h-.775zM4.519 3.617h.775v.71h-.775zM.755 4.833h.775v.71H.755zM2.599 4.833h.775v.71h-.775zM4.519 4.833h.775v.71h-.775zM.755 6.019h.775v.71H.755zM2.599 6.019h.775v.71h-.775zM4.519 6.019h.775v.71h-.775z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":"none","stroke-opacity":"1","paint-order":"markers fill stroke"},transform:"translate(1.32 .087)"},null,-1)]))}const ao={},co=(0,i.A)(ao,[["render",lo]]);var ho=co;const ko={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function uo(o,t){return(0,r.uX)(),(0,r.CE)("svg",ko,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M1.371 1.714v4.688h5.41v-3.16L5.24 1.705Z",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"}},null,-1),(0,r.Lk)("path",{d:"M3.774 7.607V3.805l.768 1.426M3.798 3.837 3.15 5.121",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"translate(.179 .593)"},null,-1),(0,r.Lk)("path",{d:"M1.992 1.758v1.678h2.63V1.733",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"}},null,-1)]))}const po={},mo=(0,i.A)(po,[["render",uo]]);var wo=mo;const yo={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function vo(o,t){return(0,r.uX)(),(0,r.CE)("svg",yo,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M1.371 1.714v4.688h5.41v-3.16L5.24 1.705Z",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"}},null,-1),(0,r.Lk)("path",{d:"M3.774 7.607V3.805l.768 1.426M3.798 3.837 3.15 5.121",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"matrix(1 0 0 -1 .179 11.943)"},null,-1),(0,r.Lk)("path",{d:"M1.992 1.758v1.678h2.63V1.733",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"}},null,-1)]))}const fo={},go=(0,i.A)(fo,[["render",vo]]);var bo=go;const Lo={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Co(o,t){return(0,r.uX)(),(0,r.CE)("svg",Lo,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M1.371 1.714v4.688h5.41v-3.16L5.24 1.705Z",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"}},null,-1)]))}const xo={},Mo=(0,i.A)(xo,[["render",Co]]);var Fo=Mo;const jo={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Io(o,t){return(0,r.uX)(),(0,r.CE)("svg",jo,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M3.774 7.607V3.805l.768 1.426M3.798 3.837 3.15 5.121",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"translate(.535 -3.302)"},null,-1),(0,r.Lk)("path",{d:"M2.267 3.521h5.307L6.2 4.946H.893Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"}},null,-1)]))}const Eo={},Po=(0,i.A)(Eo,[["render",Io]]);var Ao=Po;const Oo={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function zo(o,t){return(0,r.uX)(),(0,r.CE)("svg",Oo,t[0]||(t[0]=[(0,r.Lk)("path",{d:"M3.774 7.607V3.805l.768 1.426M3.798 3.837 3.15 5.121",style:{fill:"none",stroke:"#000","stroke-width":".264583px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"},transform:"matrix(1 0 0 -1 .535 11.762)"},null,-1),(0,r.Lk)("path",{d:"M2.267 3.521h5.307L6.2 4.946H.893Z",style:{fill:"none",stroke:"#000","stroke-width":".264583","stroke-linecap":"round","stroke-linejoin":"round","paint-order":"markers fill stroke"}},null,-1)]))}const Bo={},Xo=(0,i.A)(Bo,[["render",zo]]);var Ro=Xo,$o={name:"UiPanel",emits:["addPart","updatePos","remove","deselect","color","toggleFloor","save","loadFile","reset","up","down"],components:{UpIcon:Ao,DownIcon:Ro,SaveIcon:wo,LoadIcon:bo,NewIcon:Fo,CursorIcon:Z,NailsIcon:oo,PlanksIcon:no,CodelockIcon:ho,FloorsIcon:Y},props:{cursor:{type:Array,required:!0,default:()=>[0,1,0]},selected:{type:[String,null,void 0],required:!1},construction:{type:[Object,null],required:!1,default:()=>({})},floors:{type:[Array,null,void 0],required:!1,default:()=>[]}},data(){return{cpos:{x:this.cursor[0],y:this.cursor[1],z:this.cursor[2]}}},watch:{cursor:{deep:!0,handler(o){o[0]!==this.cpos.x&&(this.cpos.x=o[0]),o[1]!==this.cpos.y&&(this.cpos.y=o[1]),o[2]!==this.cpos.z&&(this.cpos.z=o[2])}},cpos:{deep:!0,handler(o){o.x===this.cursor[0]&&o.y===this.cursor[1]&&o.z===this.cursor[2]||this.$emit("updatePos",[o.x,o.y,o.z])}}},computed:{parts(){return Object.values(this.construction).filter((o=>!this.floors.includes(o.position[1])))},resources(){const o={nails:0,planks:0,codelocks:0};return this.parts.forEach((t=>{"door"===t.part?(o.nails+=28,o.planks+=8,o.codelocks+=1):(o.nails+=20,o.planks+=10)})),o},layers(){const o=[];return Object.values(this.construction).forEach((t=>{const e=t.position[1];o.includes(e)||o.push(e)})),o}},methods:{ceil(o,t){return Math.ceil(o/t)},toggleFloor(o){this.$emit("toggleFloor",o)}}};const Do=(0,i.A)($o,[["render",S],["__scopeId","data-v-07a2d5fe"]]);var So=Do;const Ko={class:"key-helper"},Ho={key:0,class:"helper-content"};function To(o,t,e,n,i,l){return(0,r.uX)(),(0,r.CE)("div",Ko,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...o)=>l.toggle&&l.toggle(...o)),class:"helper-toggle"},(0,v.v_)(i.isOpen?"Hide":"Keys"),1),(0,r.bF)(s.eB,{name:"slide"},{default:(0,r.k6)((()=>[i.isOpen?((0,r.uX)(),(0,r.CE)("div",Ho,t[1]||(t[1]=[(0,r.Lk)("div",{class:"keys-vertical"},[(0,r.Lk)("div",{class:"key-section"},[(0,r.Lk)("h4",null,"Save/Load"),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"Ctrl+C"),(0,r.Lk)("span",{class:"desc"},"save")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"Ctrl+L"),(0,r.Lk)("span",{class:"desc"},"load")])]),(0,r.Lk)("div",{class:"key-section"},[(0,r.Lk)("h4",null,"Navigation"),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"↑↓←→"),(0,r.Lk)("span",{class:"desc"},"move X/Z")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"Q/E"),(0,r.Lk)("span",{class:"desc"},"up/down Y")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"R"),(0,r.Lk)("span",{class:"desc"},"rotate")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"Esc"),(0,r.Lk)("span",{class:"desc"},"deselect")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"Del/D"),(0,r.Lk)("span",{class:"desc"},"delete")])]),(0,r.Lk)("div",{class:"key-section"},[(0,r.Lk)("h4",null,"Colors"),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"1/2/3"),(0,r.Lk)("span",{class:"desc"},"clear/red/green")])]),(0,r.Lk)("div",{class:"key-section"},[(0,r.Lk)("h4",null,"Creation"),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"W"),(0,r.Lk)("span",{class:"desc"},"wall")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"F"),(0,r.Lk)("span",{class:"desc"},"foundation")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"P"),(0,r.Lk)("span",{class:"desc"},"platform")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"H"),(0,r.Lk)("span",{class:"desc"},"hatch platform")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"O"),(0,r.Lk)("span",{class:"desc"},"door")]),(0,r.Lk)("div",{class:"key-group"},[(0,r.Lk)("span",{class:"key"},"I"),(0,r.Lk)("span",{class:"desc"},"window")])])],-1)]))):(0,r.Q3)("",!0)])),_:1})])}var _o={name:"KeyHelper",data(){return{isOpen:!1}},methods:{toggle(){this.isOpen=!this.isOpen}}};const Zo=(0,i.A)(_o,[["render",To],["__scopeId","data-v-3c11c274"]]);var No=Zo;const Wo={class:"tool-bar"},Uo={class:"tool-group"},Vo={class:"tool-group"},Yo={class:"tool-group"},qo={class:"tool-group"},Qo=["disabled"],Jo=["disabled"],Go=["disabled"];function ot(o,t,e,s,n,i){const l=(0,r.g2)("CursorIcon"),a=(0,r.g2)("FoundationIcon"),c=(0,r.g2)("PlatformIcon"),d=(0,r.g2)("PlatformHoleIcon"),h=(0,r.g2)("StairsIcon"),k=(0,r.g2)("WallIcon"),u=(0,r.g2)("WindowIcon"),p=(0,r.g2)("DoorIcon"),m=(0,r.g2)("RampIcon"),w=(0,r.g2)("SmallRoofIcon"),y=(0,r.g2)("LongRoofIcon");return(0,r.uX)(),(0,r.CE)("div",Wo,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>o.$emit("tool","select")),class:(0,v.C4)(["tool-button",{selected:"select"===e.tool}])},[(0,r.bF)(l)],2),(0,r.Lk)("div",Uo,[(0,r.Lk)("button",{onClick:t[1]||(t[1]=t=>o.$emit("tool","foundation")),class:(0,v.C4)(["tool-button",{selected:"foundation"===e.tool}])},[(0,r.bF)(a)],2),(0,r.Lk)("button",{onClick:t[2]||(t[2]=t=>o.$emit("tool","platform")),class:(0,v.C4)(["tool-button",{selected:"platform"===e.tool}])},[(0,r.bF)(c)],2),(0,r.Lk)("button",{onClick:t[3]||(t[3]=t=>o.$emit("tool","platformhole")),class:(0,v.C4)(["tool-button",{selected:"platformhole"===e.tool}])},[(0,r.bF)(d)],2),(0,r.Lk)("button",{onClick:t[4]||(t[4]=t=>o.$emit("tool","stairs")),class:(0,v.C4)(["tool-button",{selected:"stairs"===e.tool}])},[(0,r.bF)(h)],2)]),(0,r.Lk)("div",Vo,[(0,r.Lk)("button",{onClick:t[5]||(t[5]=t=>o.$emit("tool","wall")),class:(0,v.C4)(["tool-button",{selected:"wall"===e.tool}])},[(0,r.bF)(k)],2),(0,r.Lk)("button",{onClick:t[6]||(t[6]=t=>o.$emit("tool","window")),class:(0,v.C4)(["tool-button",{selected:"window"===e.tool}])},[(0,r.bF)(u)],2),(0,r.Lk)("button",{onClick:t[7]||(t[7]=t=>o.$emit("tool","door")),class:(0,v.C4)(["tool-button",{selected:"door"===e.tool}])},[(0,r.bF)(p)],2)]),(0,r.Lk)("div",Yo,[(0,r.Lk)("button",{onClick:t[8]||(t[8]=t=>o.$emit("tool","rampup")),class:(0,v.C4)(["tool-button rampup",{selected:"ramp"===e.tool}])},[(0,r.bF)(m)],2),(0,r.Lk)("button",{onClick:t[9]||(t[9]=t=>o.$emit("tool","rampdown")),class:(0,v.C4)(["tool-button",{selected:"ramp"===e.tool}])},[(0,r.bF)(m)],2),(0,r.Lk)("button",{onClick:t[10]||(t[10]=t=>o.$emit("tool","smallroof")),class:(0,v.C4)(["tool-button",{selected:"smallroof"===e.tool}])},[(0,r.bF)(w)],2),(0,r.Lk)("button",{onClick:t[11]||(t[11]=t=>o.$emit("tool","longroof")),class:(0,v.C4)(["tool-button",{selected:"longroof"===e.tool}])},[(0,r.bF)(y)],2)]),(0,r.Lk)("div",qo,[(0,r.Lk)("button",{onClick:t[12]||(t[12]=t=>o.$emit("color","clear")),disabled:!e.selection,class:"tool-button button-clear"},null,8,Qo),(0,r.Lk)("button",{onClick:t[13]||(t[13]=t=>o.$emit("color","green")),disabled:!e.selection,class:"tool-button button-green"},null,8,Jo),(0,r.Lk)("button",{onClick:t[14]||(t[14]=t=>o.$emit("color","red")),disabled:!e.selection,class:"tool-button button-red"},null,8,Go)])])}const tt={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function et(o,t){return(0,r.uX)(),(0,r.CE)("svg",tt,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m58.43 111.614 3.358 70.11-6.974 1.815-4.149-2.226-4.692-81.44 69.953-8.46 56.303 11.914-4.405 85.12-6.365 2.119 4.381-78.984L103.75 123.1l.876 87.487-8.155 2.699-6.064-3.68-1.877-87.228-37.992-13.19 4.317 74.81",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.292 -1.921)"}),(0,r.Lk)("path",{d:"m96.294 213.323-1.717-97.454-48.125-15.403M94.283 115.867l77.884-12.422M158.703 113.37l-3.559 74.376 6.71 2.779M120.66 120.24l-.355 46.001-5.7 1.284-4.792-1.886.234-43.885M115.14 167.709l.84-47.085",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.292 -1.921)"})],-1)]))}const st={},rt=(0,i.A)(st,[["render",et]]);var nt=rt;const it={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function lt(o,t){return(0,r.uX)(),(0,r.CE)("svg",it,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m24.498 100.387.546 8.234 57.285 19.11 108.99-14.455.913-9.419-71.845-12.713z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.01 -.172)"}),(0,r.Lk)("path",{d:"m24.889 101.024 56.528 16.254 110.97-13.354M81.884 127.703 81.5 117.14",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.01 -.172)"})],-1)]))}const at={},ct=(0,i.A)(at,[["render",lt]]);var dt=ct;const ht={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function kt(o,t){return(0,r.uX)(),(0,r.CE)("svg",ht,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.21314809","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m24.498 100.387.546 8.234 57.285 19.11 108.99-14.455.913-9.419-71.845-12.713z",style:{fill:"none",stroke:"#000","stroke-width":"6.21314809","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04258 -.0002 .0002 .04258 -.309 -.28)"}),(0,r.Lk)("path",{d:"m24.889 101.024 56.528 16.254 110.97-13.354M81.884 127.703 81.5 117.14",style:{fill:"none",stroke:"#000","stroke-width":"6.21314809","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04258 -.0002 .0002 .04258 -.309 -.28)"}),(0,r.Lk)("path",{d:"m72.273 108.188 21.209 5.608 84.483-10.381-24.734-4.487zM152.96 99.086l.166 7.247",style:{fill:"none",stroke:"#000","stroke-width":"6.38646575","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.197 -.16)"})],-1)]))}const ut={},pt=(0,i.A)(ut,[["render",kt]]);var mt=pt;const wt={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function yt(o,t){return(0,r.uX)(),(0,r.CE)("svg",wt,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"4.28035139","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m97.645 125.376-28.75 2.801-10.337-7.534 26.61-2.218zM98.425 126.486l5.512 33.617-29.512 4.25-5.178-35.794",style:{fill:"none",stroke:"#000","stroke-width":"4.28035139","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.06181 0 0 .06181 -1.44 -2.587)"}),(0,r.Lk)("path",{d:"m58.173 120.765.424 29.526 16.005 14.164M98.285 125.749l40.301-70.914-16.284-1.726-36.704 65.103",style:{fill:"none",stroke:"#000","stroke-width":"4.28035139","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.06181 0 0 .06181 -1.44 -2.587)"})],-1)]))}const vt={},ft=(0,i.A)(vt,[["render",yt]]);var gt=ft;const bt={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Lt(o,t){return(0,r.uX)(),(0,r.CE)("svg",bt,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline"}},[(0,r.Lk)("path",{d:"m48.377 41.603 111.852 4.628-.117 111.479-111.415 4.345Z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.09 -.129)"})],-1)]))}const Ct={},xt=(0,i.A)(Ct,[["render",Lt]]);var Mt=xt;const Ft={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function jt(o,t){return(0,r.uX)(),(0,r.CE)("svg",Ft,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m48.377 41.603 111.852 4.628-.117 111.479-111.415 4.345Z",style:{display:"inline",fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.031 -.012)"}),(0,r.Lk)("path",{d:"m62.652 66.35.202 46.496 83.917-1.075-.32-44.055z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.031 -.012)"})],-1)]))}const It={},Et=(0,i.A)(It,[["render",jt]]);var Pt=Et;const At={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Ot(o,t){return(0,r.uX)(),(0,r.CE)("svg",At,t[0]||(t[0]=[(0,r.Lk)("g",{style:{fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"m49.029 41.736-.478 119.732 36.217-1.25.403-92.977 41.277.88.057 89.925 33.626-1.284-.263-110.367z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.025 .005)"})],-1)]))}const zt={},Bt=(0,i.A)(zt,[["render",Ot]]);var Xt=Bt;const Rt={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function $t(o,t){return(0,r.uX)(),(0,r.CE)("svg",Rt,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"M118.038 95.787 21.77 152.166l3.205 3.359 55.16 13.817L191.223 96.88l-2.669-3.593Z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.38 .877)"}),(0,r.Lk)("path",{d:"m188.504 93.434-112.27 71.847-54.589-13.015M76.723 165.483l3.051 4.095",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.38 .877)"})],-1)]))}const Dt={},St=(0,i.A)(Dt,[["render",$t]]);var Kt=St;const Ht={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Tt(o,t){return(0,r.uX)(),(0,r.CE)("svg",Ht,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"M73.144 55.293 31.72 149.792l47.759 13.649 5.647-.569 43.158-108.386 3.84.841 35.92 99.837 4.698-1.013-41.318-111.048-3.483-.291z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 .125 -.098)"}),(0,r.Lk)("path",{d:"m100.551 124.15 8.444 20.122 59.53 10.836M127.907 43.127 79.494 163.579",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 .125 -.098)"})],-1)]))}const _t={},Zt=(0,i.A)(_t,[["render",Tt]]);var Nt=Zt;const Wt={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 8.467 8.467"};function Ut(o,t){return(0,r.uX)(),(0,r.CE)("svg",Wt,t[0]||(t[0]=[(0,r.Lk)("g",{style:{display:"inline",fill:"none",stroke:"#000","stroke-opacity":"1","stroke-width":"6.38646664","stroke-dasharray":"none"}},[(0,r.Lk)("path",{d:"M111.086 55.485 30.4 146.887l2.583 2.536L79.24 163.55l93.302-115.859-2.913-3.29z",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.02 -.01)"}),(0,r.Lk)("path",{d:"M169.631 44.79 76.376 160.26 30.24 147.162M79.428 163.385l-2.946-3.254",style:{fill:"none",stroke:"#000","stroke-width":"6.38646664","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1","stroke-dasharray":"none"},transform:"matrix(.04143 0 0 .04143 -.02 -.01)"})],-1)]))}const Vt={},Yt=(0,i.A)(Vt,[["render",Ut]]);var qt=Yt,Qt={name:"ToolBar",emits:["tool","color"],components:{FoundationIcon:nt,PlatformIcon:dt,StairsIcon:gt,PlatformHoleIcon:mt,WallIcon:Mt,DoorIcon:Xt,RampIcon:Kt,SmallRoofIcon:Nt,LongRoofIcon:qt,WindowIcon:Pt,CursorIcon:Z},props:{tool:{type:[String,null],required:!0},selection:{type:[Object,null],required:!0}}};const Jt=(0,i.A)(Qt,[["render",ot],["__scopeId","data-v-4fda9ab6"]]);var Gt=Jt;const oe=o=>new Promise((t=>setTimeout(t,o))),te=new y.B,ee=o=>JSON.parse(JSON.stringify(o)),se=o=>new Promise((t=>{te.load("./glb/"+o+".glb",(o=>{const e=o.scene.children[0];t(e)}),void 0,(e=>{console.error("load error",o,e),t(null)}))})),re=o=>o instanceof p.B69&&(o.geometry&&o.geometry.dispose(),o.material&&(o.material instanceof Array?o.material.forEach((o=>o.dispose())):o.material.dispose()),o.removeFromParent(),!0),ne={scene:null,camera:null,renderer:null,grid:null,lgrid:null,controls:null,ambient:null,lights:{},models:{},materials:{},holo:null};var ie={name:"HomeView",components:{UiPanel:So,KeyHelpmer:No,ToolBar:Gt},data(){return{cursor:[0,1,0],tool:"select",lock:null,selection:null,construction:{},hiddenFloors:[],holoR:0}},async created(){await oe(0),ne.scene=new p.Z58,ne.scene.background=new p.Q1f(6710886);const o=this.$refs.v3d.getBoundingClientRect();ne.camera=new p.ubm(50,o.width/o.height,.1,1e3),ne.camera.position.x=5,ne.camera.position.z=5,ne.camera.position.y=5,ne.camera.lookAt(new p.Pq0(0,0,0)),ne.renderer=new m.JeP({canvas:this.$refs.canvas,alpha:!0,antialias:!0}),ne.renderer.shadowMap.enabled=!0,ne.renderer.shadowMap.type=p.Wk7,ne.renderer.setSize(o.width,o.height),ne.renderer.setAnimationLoop((()=>this.animate())),ne.lgrid=new p.fTw(10,10,11184895,10066363),ne.scene.add(ne.lgrid),ne.controls=new w.N(ne.camera,this.$refs.canvas),ne.controls.target.set(0,0,0),ne.lights.ambient=new p.$p8(16777215,.6),ne.scene.add(ne.lights.ambient),ne.lights.hemi=new p.dth(14527231,5653317,.8),ne.scene.add(ne.lights.hemi),ne.lights.dir=new p.ZyN(16777215,2),ne.lights.dir.position.set(10,20,10),ne.lights.dir.castShadow=!0,ne.lights.dir.shadow.mapSize.width=2048,ne.lights.dir.shadow.mapSize.height=2048,ne.lights.dir.shadow.camera.near=.5,ne.lights.dir.shadow.camera.far=50,ne.lights.dir.shadow.camera.left=-20,ne.lights.dir.shadow.camera.right=20,ne.lights.dir.shadow.camera.top=20,ne.lights.dir.shadow.camera.bottom=-20,ne.scene.add(ne.lights.dir);const t=new p.bdM(1,1);ne.cursorMaterial=new p.V9B({color:1401481,side:p.$EB,transparent:!0,opacity:.9}),ne.cursor=new p.eaF(t,ne.cursorMaterial),ne.cursor.rotateX(Math.PI/2),ne.cursor.position.set(this.cursor[0]+.5,this.cursor[1]-1,this.cursor[2]+.5),ne.scene.add(ne.cursor),ne.bbox=new p.IWo,ne.bbox.renderOrder=1e3,ne.scene.add(ne.bbox);const e=new p.bdM(100,100);ne.mplane=new p.eaF(e,ne.cursorMaterial),ne.mplane.layers.set(2),ne.mplane.rotateX(Math.PI/2),ne.scene.add(ne.mplane),await this.loadModel("foundation"),await this.loadModel("door"),await this.loadModel("window"),await this.loadModel("wall"),await this.loadModel("loongroof","longroof"),await this.loadModel("platform"),await this.loadModel("platformhole"),await this.loadModel("ramp"),await this.loadModel("smallroof"),await this.loadModel("stairs"),ne.materials.wood=new p._4j({color:10387811,transparent:!0}),ne.materials.gray=new p._4j({color:5131854,transparent:!0}),ne.materials.red=new p._4j({color:10374734,transparent:!0}),ne.materials.green=new p._4j({color:5152334,transparent:!0}),ne.raycaster=new p.tBo},mounted(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("resize",this.onWindowResize)},beforeUnmount(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("resize",this.onWindowResize)},methods:{onWindowResize(){const o=this.$refs.v3d.getBoundingClientRect();ne.renderer.setSize(o.width,o.height),ne.camera.aspect=o.width/o.height,ne.camera.updateProjectionMatrix()},onKeyDown(o){if("INPUT"===o.target.tagName||"TEXTAREA"===o.target.tagName)return;const t=["Delete","Backspace"];switch(t.includes(o.code)&&o.preventDefault(),o.code){case"Delete":case"Backspace":case"KeyD":this.removeSelection();break;case"KeyR":this.rotateSelection();break;case"Escape":ne.holo?this.onTool("select"):this.onDeselect();break;case"ArrowUp":this.moveCursor(0,0,-1);break;case"ArrowDown":this.moveCursor(0,0,1);break;case"ArrowLeft":this.moveCursor(-1,0,0);break;case"ArrowRight":this.moveCursor(1,0,0);break;case"KeyQ":this.moveCursor(0,1,0);break;case"KeyE":this.moveCursor(0,-1,0);break;case"Digit1":this.setColor("clear");break;case"Digit2":this.setColor("red");break;case"Digit3":this.setColor("green");break;case"KeyW":this.onTool("wall");break;case"KeyF":this.onTool("foundation");break;case"KeyP":this.onTool("platform");break;case"KeyH":this.onTool("platformhole");break;case"KeyO":this.onTool("door");break;case"KeyI":this.onTool("window");break;case"KeyC":(o.ctrlKey||o.metaKey)&&(o.preventDefault(),this.save());break;case"KeyL":(o.ctrlKey||o.metaKey)&&(o.preventDefault(),this.$refs.uiPanel.$refs.fileInput.click());break}},moveCursor(o,t,e){const s=[this.cursor[0]+o,this.cursor[1]+t,this.cursor[2]+e];this.updateCursor(s)},animate(){ne.controls.update(),ne.renderer.render(ne.scene,ne.camera)},async loadModel(o,t){const e=await se(o);ne.models[t||o]=e},updateCursor(o){this.cursor=o,ne.cursor.position.set(this.cursor[0]+.5,this.cursor[1]-.999,this.cursor[2]+.5),ne.lgrid.position.y=this.cursor[1]-1,ne.mplane.position.y=this.cursor[1]-1,ne.holo&&this.spMesh(ne.holo,this.tool,0,!1)},addPart(o,t=0,e=!0){const s=["rampup","rampdown"].includes(o)?"ramp":o;if(!ne.models[s])return;const r=ne.models[s].material.clone();r.transparent=!0;const n=new p.eaF(ne.models[s].geometry,r);this.spMesh(n,o),n.castShadow=!0,n.receiveShadow=!0,n.layers.enable(1),ne.scene.add(n);for(let i=t;i>0;i--)n.rotateY(Math.PI/2);return this.construction[n.uuid]={part:o,position:[...this.cursor],rotation:t,color:"clear"},e?(this.selection=n,ne.bbox.setFromObject(this.selection),ne.bbox.visible=!0,this.lock=[...this.cursor],n):n},spMesh(o,t,e=0,s=!0){s&&o.scale.set(.5,.5,.5),o.position.set(this.cursor[0]+.5,this.cursor[1]-1.5+e,this.cursor[2]+.5),["foundation","platform","platformhole"].includes(t)||(o.position.y+=1),"rampdown"===t&&(o.position.y-=1),"rampup"===t&&(o.position.y-=.5),"stairs"===t&&(o.position.y-=.5),"longroof"===t&&(o.position.y-=.5)},rotateSelection(){if(ne.holo)return ne.holo.rotateY(Math.PI/2),this.holoR++,void(this.holoR>=4&&(this.holoR-=4));this.selection&&(this.selection.rotateY(Math.PI/2),this.construction[this.selection.uuid].rotation++,this.construction[this.selection.uuid].rotation>=4&&(this.construction[this.selection.uuid].rotation-=4),ne.bbox.update())},removeSelection(){this.selection&&(delete this.construction[this.selection.uuid],this.selection.removeFromParent(),this.selection=null,ne.bbox.visible=!1)},onDeselect(){this.selection=null,ne.bbox.visible=!1,this.lock=null},onTool(o){const t=this.tool;if(this.tool===o){if("select"===o)return;return this.onTool("select")}if(this.tool=o,"select"===this.tool)return ne.holo&&(re(ne.holo),ne.holo=null,this.holoR=0),this.onDeselect(),void(ne.cursor.visible=!0);const e="rampup"===this.tool||"rampdown"===this.tool?"ramp":this.tool;if(!ne.models[e])return void console.warn("unknown tool",e);ne.cursor.visible=!1,ne.holo&&re(ne.holo);const s=ne.models[e].geometry.clone(),r=ne.cursorMaterial.clone();if(ne.holo=new p.eaF(s,r),"select"===t)this.holoR=0;else for(let n=this.holoR;n>0;n--)ne.holo.rotateY(Math.PI/2);this.spMesh(ne.holo,this.tool,-1),ne.scene.add(ne.holo)},onClick(o){if(ne.holo)return void this.addPart(this.tool,this.holoR,!1);ne.raycaster.layers.set(1);const t=new p.I9Y;t.x=o.clientX/window.innerWidth*2-1,t.y=-o.clientY/window.innerHeight*2+1,ne.raycaster.setFromCamera(t,ne.camera);const e=ne.raycaster.intersectObjects(ne.scene.children);e[0]&&e[0].object?this.selection&&e[0].object.uuid===this.selection.uuid?this.onDeselect():(this.selection=e[0].object,ne.bbox.setFromObject(this.selection),ne.bbox.visible=!0):this.lock||(this.lock=[...this.cursor])},onMove(o){if(this.lock||!ne.raycaster)return;ne.raycaster.layers.set(2);const t=new p.I9Y;t.x=o.clientX/window.innerWidth*2-1,t.y=-o.clientY/window.innerHeight*2+1,ne.raycaster.setFromCamera(t,ne.camera);const e=ne.raycaster.intersectObjects(ne.scene.children);if(e[0]){const o=e[0].point,t=[...this.cursor];this.updateCursor([Math.floor(o.x),t[1],Math.floor(o.z)])}},setColor(o){if(!this.selection)return;const t=this.selection.material;t.emissiveIntensity="clear"===o?0:.1,"green"===o&&(t.emissive=new p.Q1f(65280)),"red"===o&&(t.emissive=new p.Q1f(16711680))},toggleFloor(o){this.hiddenFloors.includes(o)?this.hiddenFloors=this.hiddenFloors.filter((t=>t!==o)):this.hiddenFloors.push(o),this.setFloors()},setFloors(){Object.keys(this.construction).forEach((o=>{const t=this.construction[o],e=t.position[1],s=ne.scene.getObjectByProperty("uuid",o);s&&(this.hiddenFloors.includes(e)?(s.layers.disable(1),s.material.opacity=.05):(s.layers.enable(1),s.material.opacity=1))}))},save(){const o={type:"construction/freedom",version:1,construction:ee(this.construction),floors:ee(this.hiddenFloors)},t=JSON.stringify(o),e=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download="construction.json",r.click()},async loadFile(o){const t=await o.text();let e=null;try{e=JSON.parse(t)}catch(s){console.error("read file",s),e=null}e&&("construction/freedom"===e.type&&1===e.version?(this.reset(),Object.values(e.construction).forEach((o=>{this.updateCursor(o.position),this.addPart(o.part,o.rotation),this.setColor(o.color)})),this.hiddenFloors=[...e.floors],this.setFloors()):console.error("format not supported"))},reset(){this.onDeselect(),this.selection=null,Object.keys(this.construction).forEach((o=>{const t=ne.scene.getObjectByProperty("uuid",o);t&&t.removeFromParent()})),this.updateCursor([0,1,0])}},watch:{layer(o){ne.lgrid.position.y=o-1}}};const le=(0,i.A)(ie,[["render",u]]);var ae=le;const ce=[{path:"/",name:"home",component:ae}],de=(0,d.aE)({history:(0,d.LA)("/dayz-freedom-calculator/"),routes:ce});var he=de,ke=e(591),ue=(0,ke.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,s.Ef)(c).use(ue).use(he).mount("#app")}},t={};function e(s){var r=t[s];if(void 0!==r)return r.exports;var n=t[s]={exports:{}};return o[s].call(n.exports,n,n.exports,e),n.exports}e.m=o,function(){var o=[];e.O=function(t,s,r,n){if(!s){var i=1/0;for(d=0;d<o.length;d++){s=o[d][0],r=o[d][1],n=o[d][2];for(var l=!0,a=0;a<s.length;a++)(!1&n||i>=n)&&Object.keys(e.O).every((function(o){return e.O[o](s[a])}))?s.splice(a--,1):(l=!1,n<i&&(i=n));if(l){o.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=o.length;d>0&&o[d-1][2]>n;d--)o[d]=o[d-1];o[d]=[s,r,n]}}(),function(){e.n=function(o){var t=o&&o.__esModule?function(){return o["default"]}:function(){return o};return e.d(t,{a:t}),t}}(),function(){e.d=function(o,t){for(var s in t)e.o(t,s)&&!e.o(o,s)&&Object.defineProperty(o,s,{enumerable:!0,get:t[s]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(o){if("object"===typeof window)return window}}()}(),function(){e.o=function(o,t){return Object.prototype.hasOwnProperty.call(o,t)}}(),function(){var o={524:0};e.O.j=function(t){return 0===o[t]};var t=function(t,s){var r,n,i=s[0],l=s[1],a=s[2],c=0;if(i.some((function(t){return 0!==o[t]}))){for(r in l)e.o(l,r)&&(e.m[r]=l[r]);if(a)var d=a(e)}for(t&&t(s);c<i.length;c++)n=i[c],e.o(o,n)&&o[n]&&o[n][0](),o[n]=0;return e.O(d)},s=self["webpackChunkhcalc"]=self["webpackChunkhcalc"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=e.O(void 0,[504],(function(){return e(3985)}));s=e.O(s)})();
//# sourceMappingURL=app.70a3abba.js.map